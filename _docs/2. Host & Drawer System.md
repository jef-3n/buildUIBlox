# **Design Guidance: 2\. Host & Drawer System**

## **1\. Purpose**

The Host & Drawer System governs the 4-Axis orchestration of the IDE's primary workspace and the "Variable Density Engine." Its fundamental role is to manage the spatial layout of the interface, ensuring that the user’s cognitive load is minimized while maximizing available screen real estate. By treating the layout as a dynamic, synchronized environment, it allows surfaces to interact with one another across physical device boundaries, creating a unified multiscreen development experience.

## **2\. Architecture & Data Consumption**

This module is the primary consumer of the **UI State**. It operates as a reactive observer, constantly monitoring state changes to determine visibility, panel dimensions, and scaling factors for the rendering stage.

* **Context Subscription:** Subscribes to the global Firestore path session.ui.drawers for layout state and session.ui.scale for canvas density. It also tracks activeSurface to resolve focus conflicts.  
* **Data Structure:**  
  {  
    "ui": {  
      "drawers": {   
        "top": true,   
        "left": true,   
        "right": true,   
        "bottom": true   
      },  
      "scale": 1 | 2 | 3 | 4 | 5,  
      "activeSurface": "instanceId",  
      "lastInteraction": "timestamp"  
    }  
  }

## **3\. Events & Handlers**

The system relies on a strictly typed event protocol to ensure that state transitions are predictable and performant.

| Event Type | Payload Schema | Handler Description |
| :---- | :---- | :---- |
| UI\_TOGGLE\_DRAWER | { side: 'top' | 'left' | 'right' | 'bottom' } | Modifies the boolean visibility state in the Design State. This triggers a global layout shift where the CSS Grid tracks animate to their new fractional or fixed units. |
| UI\_SET\_SCALE | { scale: number } | Injects a new integer (1-5) into the density engine. This updates the transform: scale() property of the Center Canvas and re-calculates the Ghost Layer's coordinate mapping to maintain interaction accuracy. |
| UI\_FOCUS\_SURFACE | { instanceId: string } | Designates which browser instance (e.g., the Laptop vs. the Tablet) is the "Master" surface. This determines which window receives the high-fidelity event sniffer logs and selection highlighting. |
| UI\_RESET\_LAYOUT | {} | Reverts all drawers to their default factory visibility and sets scale to 1\. Used as a recovery mechanism if the layout becomes cluttered or inaccessible. |

## **4\. Architectural Rules**

### **4.1 Pure CSS & Native Performance**

The Host skeleton must be constructed using standard CSS Grid and Flexbox tracks. The use of utility frameworks like Tailwind is strictly forbidden for the Host layer to minimize dependency bloat and ensure the IDE remains lean. The layout should utilize CSS Variables (e.g., \--drawer-left-width) to allow the compiler to perform surgical updates to the interface without full DOM re-renders.

### **4.2 State Synchronicity & Remote Orchestration**

All drawer states and scaling factors must be reflected in the Firestore Design State in real-time. This enables "Remote Orchestration"—a feature where a user on a primary "Master" monitor can collapse drawers or zoom in on a secondary "Preview" monitor (such as a mobile device) without touching the secondary device. Every instance is a mirror of the global UI state, ensuring a seamless collaborative flow.

### **4.3 Variable Density Logic**

The "Variable Density Engine" is not just a zoom tool; it is a conceptual shift in perspective.

* **At ![][image1] Density:** The engine focuses on "Pixel Fidelity," providing a 1:1 representation of the final artifact for aesthetic verification.  
* **At ![][image2] Density:** The engine transforms the view into a "Logic Map." At this micro-scale, individual components become nodes in an event-driven flow, allowing developers to see the "Ghost Layer" triggers and data-binding paths across the entire application at once.

### **4.4 Fluid Layout Constraints**

Drawers must be designed to respect fluid unit constraints. While width/height values can be defined in rem or px, the Center Canvas must always occupy the 1fr space within the grid, ensuring it expands and contracts gracefully as panels slide in and out of the viewport.

[image1]: <data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABYAAAAUCAYAAACJfM0wAAABPUlEQVR4XmNgGLZAQUGBQ1FRURyGZWRkhIDCjKKiojzI4iB1KBqVlZXF5OXlS+Tk5NJQJKBASUlJDSifBcQPgPgoEHsDhVmABjkA2WeA+nYAcQwQC4I1gGyAaqgF4gNAnINqJApgAcpPBeL9IIeABEAWAA3LMzY2ZkVXDAYgLwEVrSZgMMggJyB+DsSBQGwExNU4DQUBYg1WUVHhA/pyE9CVJ0G+FBcX50ZXgwKINRgEgGqSgPgJ0AILdDkMQKzBIBcD1UwFuvgRkC5Bl8cAxBgMDYYOoBpFkOHySJGIExAyGBRBQLlqIDYC8eWRIhFdLQrAZzAoSQK9Xg+kzWFisEgEql+CkSlgACgZDZRcCXXBNaAh04E5SxeUk4D8OUC5W0D6A5BuACpnhqb9Gmg4fwDiraCMgmbsKBgF9AIADl1SbnfyKuEAAAAASUVORK5CYII=>

[image2]: <data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABYAAAAUCAYAAACJfM0wAAABkElEQVR4Xu2TP0sDQRTELySCoIh/OA/Jkcslh42NmELBJthaWSsWKS2sFIso2ikBRQs7EQsbsRMEC8HKQvATCIKIYJuP4G/M3XpZo52NZGDY3ffmze7tvnOcf4tisdgbhqGX0Pf9YcIZ13X703HpTFGhUNgNguAUNuA+yQsKoy9bxymVSuPkVuALvIfzhHNoq8wf8biBS3DIFJE4UAHBV3hmm6aQQ3cM78rl8qgC2oCa1Uql0mOLdeINfYYd7wSM5uA7XIBTsN7RVJBxPp/3dYrk7mxNgiiKBvj8K2oeMN3yPK/P1hggaCA+gpPM13U1vxWQr8E39DN2rg3sPpEYcfIRim7hoq0TdGLds96Dcc3Op5Fh50HGrBZqHwou9QXtMnMNe+RDmQepR/yG+AGeOcGy1j8Z64GI16WP68wjpnUG6k9MDjmNqzXCsaDVp6ZATc/G24zTSSx5RHTnbT9FChmSNXWGzILWj/LZQmpB5icUPjE2GXfQZ2XEejO+5ya8Jla1fFvQXSGcjdutiy7+AB9HDl7dkZkBjAAAAABJRU5ErkJggg==>